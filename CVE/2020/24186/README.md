# CVE-2020-24186

## Details

According to [Wordfence](https://www.wordfence.com/blog/2020/07/critical-arbitrary-file-upload-vulnerability-patched-in-wpdiscuz-plugin/), there's a critical vulnerability in the Wordpress plugin **Discuz**, in particular the versions 7.x.x, except from 7.0.5 upwards which are patched.

The vulnerability stems from an improper check on the file extension on images uploaded through this plugin:

> The wpDiscuz comments are intended to only allow image attachments. However, due to the file mime type detection functions that were used, the file type verification could easily be bypassed, allowing unauthenticated users the ability to upload any type of file, including PHP files.

Thanks to it, attackers can obtain Unauthenticated Remote Command Execution on the server.

## Exploit

To deceive the mime-type check, you can simply include the PNG/JPEG header followed by you PHP script. See the python script for more details.

Before actually running it, you have to change the parameter `post_url` inside the script, and then you're ready to go.

To run it:

```bash
python3 CVE-2020-24186.py
```

## Author

[Robert Raducioiu](https://www.linkedin.com/in/rbct/) ([rbct](https://docs.rbct.it/))
